<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Munch Box - Website Features</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#fafafa; }
    header { background:#ff7043; color:#fff; padding:20px; text-align:center; font-size:2.5em; font-family:'Pacifico', cursive; letter-spacing:2px; }
    .container { max-width:900px; margin:30px auto; background:#fff; padding:25px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); }
    h2 { color:#333; margin-top:20px; }
    label { display:block; margin:12px 0; padding:10px; background:#f4f4f4; border-radius:8px; cursor:pointer; transition:0.2s; }
    label:hover { background:#e8e8e8; }
    input[type="checkbox"] { margin-right:12px; transform:scale(1.3); accent-color:#ff7043; }
    button { display:block; margin:30px auto; padding:12px 30px; background:#ff7043; color:#fff; border:none; border-radius:8px; font-size:1.2em; cursor:pointer; transition:0.3s; }
    button:hover { background:#e85c2f; }
    #totalDisplay { margin-top:25px; font-size:1.4em; font-weight:bold; text-align:right; background:#fff7f4; padding:15px 18px; border:2px dashed #ff7043; border-radius:10px; }
  </style>
</head>
<body>
  <header>Munch Box</header>

  <div class="container" id="checklist">
    <h2>ðŸ“¦ Base Package (â‚¹40,000)</h2>
    <form id="featureForm">
      <!-- Base features -->
      <label class="base-feature"><input type="checkbox" checked disabled> Custom Website (Responsive Design)</label>
      <label class="base-feature"><input type="checkbox" checked disabled> Digital Menu with Images & Categories</label>
      <label class="base-feature"><input type="checkbox" checked disabled> Table-wise QR Code Scanning</label>
      <label class="base-feature"><input type="checkbox" checked disabled> Cart & Order Placement</label>
      <label class="base-feature"><input type="checkbox" checked disabled> Admin Dashboard for Orders</label>
      <label class="base-feature"><input type="checkbox" checked disabled> Secure Payment Gateway Integration</label>

      <h2>âž• Add-On Features</h2>
      <!-- Add-on features -->
      <label class="addon-feature"><input type="checkbox"> Live Order Status Update (â‚¹3,000)</label>
      <label class="addon-feature"><input type="checkbox"> Customer Reviews & Ratings (â‚¹2,500)</label>
      <label class="addon-feature"><input type="checkbox"> Suggestion/Feedback Form (â‚¹1,500)</label>
      <label class="addon-feature"><input type="checkbox"> Loyalty Points / Discount Coupons (â‚¹4,000)</label>
      <label class="addon-feature"><input type="checkbox"> WhatsApp/SMS Notifications (â‚¹3,500)</label>
      <label class="addon-feature"><input type="checkbox"> Chatbot Helper (â‚¹5,000)</label>
      <label class="addon-feature"><input type="checkbox"> Schedule Your Table Appointment (â‚¹3,000)</label>
      <label class="addon-feature"><input type="checkbox"> Advanced Sales Report & Analytics (â‚¹4,500)</label>
      <label class="addon-feature"><input type="checkbox"> Multi-Language Menu Support (â‚¹2,000)</label>
      <label class="addon-feature"><input type="checkbox"> Customer Profile & Order History (â‚¹3,500)</label>
      <label class="addon-feature"><input type="checkbox"> Social Media Integration (â‚¹2,000)</label>
      <label class="addon-feature"><input type="checkbox"> SEO Optimized Website (â‚¹3,500)</label>
      <label class="addon-feature"><input type="checkbox"> GST/Tax Invoice Generator (â‚¹3,000)</label>
      <label class="addon-feature"><input type="checkbox"> Expense & Profit Calculator (â‚¹4,000)</label>
      <label class="addon-feature"><input type="checkbox"> Add-on Items & Upselling Suggestions (â‚¹2,500)</label>
      <!-- Newly added add-ons -->
      <label class="addon-feature"><input type="checkbox"> AR Dish Visually Visible On Table (AR Preview)(â‚¹20,000)</label>
      
      
    </form>
    <div id="totalDisplay">Total: â‚¹40,000</div>
  </div>

  <button onclick="downloadPDF()">Submit & Download PDF</button>

  <script>
    const formatter = new Intl.NumberFormat('en-IN');
    const BASE_PRICE = 40000;

    function extractAddOnPrices() {
      document.querySelectorAll('.addon-feature').forEach(label => {
        const text = label.textContent;
        const match = text.match(/â‚¹([0-9,]+)/);
        if (match) {
          const price = parseInt(match[1].replace(/,/g, ''), 10);
          label.dataset.price = price;
        }
      });
    }

    function calcTotal() {
      let addOns = 0;
      document.querySelectorAll('.addon-feature input[type="checkbox"]:checked').forEach(cb => {
        const lbl = cb.closest('label');
        addOns += parseInt(lbl.dataset.price || '0', 10);
      });
      return BASE_PRICE + addOns;
    }

    function updateTotalDisplay() {
      const total = calcTotal();
      document.getElementById('totalDisplay').textContent = 'Total: â‚¹' + formatter.format(total);
    }

    function attachEvents() {
      document.querySelectorAll('.addon-feature input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', updateTotalDisplay);
      });
    }

    function buildPDFContent() {
      const total = calcTotal();
      const today = new Date().toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' });

      const wrapper = document.createElement('div');
      wrapper.className = 'pdf-root';
      wrapper.innerHTML = `
        <style>
          .pdf-root { font-family: 'Arial', sans-serif; color:#222; }
          .pdf-header { background: linear-gradient(135deg,#ff7043,#ff915f); padding:28px 30px 24px; color:#fff; border-radius:18px; box-shadow:0 4px 14px rgba(0,0,0,0.15); }
          .pdf-header h1 { margin:0; font-size:2.2em; letter-spacing:1px; }
          .pdf-header .tagline { margin:6px 0 0; font-size:0.95em; opacity:0.9; }
          .pdf-header .date { margin-top:8px; font-size:0.8em; font-weight:600; background:rgba(255,255,255,0.18); display:inline-block; padding:4px 10px; border-radius:20px; }
          .section { margin-top:28px; padding:22px 24px; border:1px solid #ffe0d3; border-radius:16px; background:linear-gradient(180deg,#fff,#fff8f5); position:relative; }
          .section:before { content:""; position:absolute; inset:0; border-radius:16px; padding:1px; background:linear-gradient(135deg,#ff7043,#ffc1ac); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite:xor; mask-composite:exclude; }
          .section-title { margin:0 0 14px; font-size:1.25em; display:flex; align-items:center; gap:8px; color:#ff5a22; }
          .section-title span.emoji { font-size:1.2em; }
          ul.feature-list { list-style:none; padding:0; margin:0; display:grid; grid-template-columns:1fr 1fr; gap:10px 26px; }
          ul.feature-list li { background:#ffffff; border:1px solid #ffe0d3; padding:10px 12px 9px 14px; border-radius:10px; font-size:0.9em; line-height:1.25em; position:relative; box-shadow:0 2px 4px rgba(0,0,0,0.04); display:flex; align-items:flex-start; gap:8px; }
          ul.feature-list li:before { content:'âœ”'; color:#ff7043; font-weight:700; }
          .summary-box { margin-top:30px; background:linear-gradient(135deg,#fff0ea,#ffe9e1); border:2px dashed #ff8a57; padding:22px 26px 24px; border-radius:18px; text-align:center; }
          .summary-box h2 { margin:0 0 10px; font-size:1.6em; color:#ff4e14; }
          .summary-box .amount { font-size:2.1em; font-weight:700; letter-spacing:1px; color:#d83d00; text-shadow:0 2px 4px rgba(0,0,0,0.08); }
          .contacts { margin-top:34px; padding:20px 22px 18px; border-radius:16px; background:#1f1f1f; color:#fafafa; }
          .contacts h3 { margin:0 0 14px; font-size:1.05em; letter-spacing:1px; text-transform:uppercase; color:#ffb199; }
          .contacts ul { list-style:none; margin:0; padding:0; display:grid; gap:8px; }
          .contacts li { display:flex; align-items:center; gap:10px; font-size:0.9em; background:#2b2b2b; padding:10px 12px; border-radius:10px; }
          .contacts li span.icon { background:#ff7043; color:#fff; width:26px; height:26px; display:flex; align-items:center; justify-content:center; border-radius:8px; font-size:0.85em; font-weight:600; box-shadow:0 2px 6px rgba(0,0,0,0.25); }
          .footer-note { margin-top:28px; font-size:0.65em; text-align:center; opacity:0.65; letter-spacing:0.5px; }
          @media (max-width:600px){ ul.feature-list { grid-template-columns:1fr; } .pdf-header h1 { font-size:1.8em; } }
        </style>
        <div class="pdf-header">
          <h1>Munch Box</h1>
          <div class="tagline">Customized Digital Restaurant Experience</div>
          <div class="date">Proposal Date: ${today}</div>
        </div>
        <div class="section">
          <h3 class="section-title"><span class="emoji">âœ…</span> Base Package (â‚¹${formatter.format(BASE_PRICE)})</h3>
          <ul class="feature-list" id="baseList"></ul>
        </div>
        <div class="section" id="addOnSection" style="display:none;">
          <h3 class="section-title"><span class="emoji">âž•</span> Selected Add-On Features</h3>
          <ul class="feature-list" id="addOnList"></ul>
        </div>
        <div class="summary-box">
          <h2>Total Investment</h2>
          <div class="amount">â‚¹${formatter.format(total)}</div>
        </div>
        <div class="contacts">
          <h3>Contact Details</h3>
          <ul>
            <li><span class="icon">R</span> <strong>Rachit Agrawal</strong> &nbsp; | &nbsp; +91 87918 04428</li>
            <li><span class="icon">A</span> <strong>Arman Ahmed</strong> &nbsp; | &nbsp; +91 95487 84462</li>
          </ul>
        </div>
        <div class="footer-note">Generated PDF â€“ Munch Box Feature Selection â€¢ This is an auto-generated summary of selected features.</div>
      `;

      // Populate lists
      const baseList = wrapper.querySelector('#baseList');
      document.querySelectorAll('.base-feature').forEach(label => {
        const li = document.createElement('li');
        li.textContent = label.textContent.trim();
        baseList.appendChild(li);
      });

      const selectedAddOns = Array.from(document.querySelectorAll('.addon-feature input[type="checkbox"]:checked'));
      if (selectedAddOns.length) {
        const addOnList = wrapper.querySelector('#addOnList');
        wrapper.querySelector('#addOnSection').style.display = '';
        selectedAddOns.forEach(cb => {
          const lbl = cb.closest('label');
          const li = document.createElement('li');
          li.textContent = lbl.textContent.trim();
          addOnList.appendChild(li);
        });
      }
      return wrapper;
    }

    function downloadPDF() {
      const pdfContent = buildPDFContent();

      // Place content off-screen for accurate measurement & scaling
      const tempHost = document.createElement('div');
      tempHost.style.position = 'fixed';
      tempHost.style.left = '-10000px';
      tempHost.style.top = '0';
      tempHost.style.width = '800px'; /* base width to measure from */
      tempHost.appendChild(pdfContent);
      document.body.appendChild(tempHost);

      // Dynamically scale to fit a single A4 page (portrait) with 0.5in margins
      // Browser CSS pixel assumption: 96 DPI. A4 height = 11.69in -> 1121px approx.
      const marginInInches = 0.5; // top & bottom each (already set in html2pdf options)
      const usableHeightPx = (11.69 - (marginInInches * 2)) * 96; // ~1027px

      const contentHeight = pdfContent.scrollHeight;
      if (contentHeight > usableHeightPx) {
        let scale = usableHeightPx / contentHeight;
        // Prevent extreme downscaling; if too tall, allow going below but note design kept.
        if (scale < 0.55) scale = 0.55; // safety floor
        pdfContent.style.transformOrigin = 'top left';
        pdfContent.style.transform = 'scale(' + scale + ')';
        // Compensate width shrink so final visual width remains similar
        pdfContent.style.width = (100 / scale) + '%';
      }

      const opt = {
        margin: 0.5,
        filename: 'MunchBox_Feature_Selection.pdf',
        image: { type: 'jpeg', quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
      };

      html2pdf().from(pdfContent).set(opt).save().then(() => {
        tempHost.remove();
      });
    }

    // Init
    extractAddOnPrices();
    attachEvents();
    updateTotalDisplay();
  </script>
</body>
</html>
